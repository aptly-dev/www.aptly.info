<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>aptly - Misc API</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=/favicon.ico><link type=text/css rel=stylesheet href=/css/styles.css><link type=text/css rel=stylesheet href=/swagger-ui/swagger-ui.css><link type=text/css rel=stylesheet href=/css/api.css><link rel=canonical href=https://www.aptly.info/doc/api/misc/><link href=/post/index.xml rel=alternate type=application/rss+xml title="Debian repository management tool"></head><body><header id=page-header><div class=container><div style=display:flex;align-items:end><div class=text-center style=font-size:9px><a class=brand href=/><i class=brand-logo></i>
<span class=brand-name>aptly</span></a></div><div style=flex-grow:1><nav class="navbar navbar-default navbar-static-top" role=navigation><ul class="nav navbar-nav nav-justified"><li><a href=/tutorial/>tutorials</a></li><li><a href=/download/>download</a></li><li><a href=/support/>support</a></li><li class=active><a href=/doc/overview/>documentation</a></li><li><a href=/about/>about</a></li><li><a href=/post/>blog</a></li></ul></nav></div></div></div><div class=container></div></header><script src=/swagger-ui/swagger-ui-bundle.js></script><script src=/swagger-ui/swagger-ui-standalone-preset.js></script><section class=documentation><div class=container><div class=sidebar-overlay></div><div class=row><div class="col-md-3 col-sm-3 col-xs-3"><div class=sidebar><ul class="nav nav-sidebar"><li><a href=/doc/overview/>Overview</a></li><li><a href=/doc/why/>Why aptly?</a></li><li><a href=/doc/faq/>FAQ</a></li><li><a href=/doc/features/>Features</a><ul class=nav><li><a href=/doc/feature/query/>Package Queries</a></li><li><a href=/doc/feature/duplicate/>Duplicate Packages</a></li><li><a href=/doc/feature/s3/>Publishing to S3</a></li><li><a href=/doc/feature/swift/>Publishing to Swift</a></li><li><a href=/doc/feature/filesystem/>Filesystem Publishing</a></li><li><a href=/doc/feature/multi-component/>Multi-Component Publishing</a></li><li><a href=/doc/feature/pgp-providers/>PGP Providers</a></li><li><a href=/doc/feature/package-display/>Package Display Format</a></li><li><a href=/doc/feature/dependencies/>Dependency Resolving</a></li></ul></li><li><a href=/doc/configuration/>Configuration</a></li><li><a href=/doc/commands/>Commands</a><ul class=nav><li><a href=/doc/aptly/flags/>Global Flags</a></li><li><a href=/doc/aptly/mirror/>aptly mirror</a><ul class=nav><li><a href=/doc/aptly/mirror/create/>aptly mirror create</a></li><li><a href=/doc/aptly/mirror/update/>aptly mirror update</a></li><li><a href=/doc/aptly/mirror/list/>aptly mirror list</a></li><li><a href=/doc/aptly/mirror/show/>aptly mirror show</a></li><li><a href=/doc/aptly/mirror/edit/>aptly mirror edit</a></li><li><a href=/doc/aptly/mirror/search/>aptly mirror search</a></li><li><a href=/doc/aptly/mirror/rename/>aptly mirror rename</a></li><li><a href=/doc/aptly/mirror/drop/>aptly mirror drop</a></li></ul></li><li><a href=/doc/aptly/repo/>aptly repo</a><ul class=nav><li><a href=/doc/aptly/repo/create/>aptly repo create</a></li><li><a href=/doc/aptly/repo/add/>aptly repo add</a></li><li><a href=/doc/aptly/repo/include/>aptly repo include</a></li><li><a href=/doc/aptly/repo/import/>aptly repo import</a></li><li><a href=/doc/aptly/repo/show/>aptly repo show</a></li><li><a href=/doc/aptly/repo/list/>aptly repo list</a></li><li><a href=/doc/aptly/repo/copy/>aptly repo copy</a></li><li><a href=/doc/aptly/repo/move/>aptly repo move</a></li><li><a href=/doc/aptly/repo/remove/>aptly repo remove</a></li><li><a href=/doc/aptly/repo/search/>aptly repo search</a></li><li><a href=/doc/aptly/repo/edit/>aptly repo edit</a></li><li><a href=/doc/aptly/repo/rename/>aptly repo rename</a></li><li><a href=/doc/aptly/repo/drop/>aptly repo drop</a></li></ul></li><li><a href=/doc/aptly/snapshot/>aptly snapshot</a><ul class=nav><li><a href=/doc/aptly/snapshot/create/>aptly snapshot create</a></li><li><a href=/doc/aptly/snapshot/list/>aptly snapshot list</a></li><li><a href=/doc/aptly/snapshot/show/>aptly snapshot show</a></li><li><a href=/doc/aptly/snapshot/verify/>aptly snapshot verify</a></li><li><a href=/doc/aptly/snapshot/pull/>aptly snapshot pull</a></li><li><a href=/doc/aptly/snapshot/filter/>aptly snapshot filter</a></li><li><a href=/doc/aptly/snapshot/diff/>aptly snapshot diff</a></li><li><a href=/doc/aptly/snapshot/merge/>aptly snapshot merge</a></li><li><a href=/doc/aptly/snapshot/search/>aptly snapshot search</a></li><li><a href=/doc/aptly/snapshot/rename/>aptly snapshot rename</a></li><li><a href=/doc/aptly/snapshot/drop/>aptly snapshot drop</a></li></ul></li><li><a href=/doc/aptly/package/>aptly package</a><ul class=nav><li><a href=/doc/aptly/package/search/>aptly package search</a></li><li><a href=/doc/aptly/package/show/>aptly package show</a></li></ul></li><li><a href=/doc/aptly/publish/>aptly publish</a><ul class=nav><li><a href=/doc/aptly/publish/snapshot/>aptly publish snapshot</a></li><li><a href=/doc/aptly/publish/repo/>aptly publish repo</a></li><li><a href=/doc/aptly/publish/update/>aptly publish update</a></li><li><a href=/doc/aptly/publish/switch/>aptly publish switch</a></li><li><a href=/doc/aptly/publish/list/>aptly publish list</a></li><li><a href=/doc/aptly/publish/show/>aptly publish show</a></li><li><a href=/doc/aptly/publish/drop/>aptly publish drop</a></li></ul></li><li><a href=/doc/aptly/db/>aptly db</a><ul class=nav><li><a href=/doc/aptly/db/cleanup/>aptly db cleanup</a></li><li><a href=/doc/aptly/db/recover/>aptly db recover</a></li></ul></li><li><a href=/doc/aptly/task/>aptly task</a><ul class=nav><li><a href=/doc/aptly/task/run/>aptly task run</a></li></ul></li><li><a href=/doc/aptly/serve/>aptly serve</a></li><li><a href=/doc/aptly/config/>aptly config</a><ul class=nav><li><a href=/doc/aptly/config/show/>aptly config show</a></li></ul></li><li><a href=/doc/aptly/graph/>aptly graph</a></li></ul></li><li><a href=/doc/api/swagger/>REST API Documentation</a></li><li class=active><a href=/doc/api/>Legacy API</a><ul class=nav><li><a href=/doc/api/repos/>Local Repos API</a></li><li><a href=/doc/api/mirror/>Mirrors API</a></li><li><a href=/doc/api/files/>File Upload API</a></li><li><a href=/doc/api/snapshots/>Snapshot API</a></li><li><a href=/doc/api/publish/>Publish API</a></li><li><a href=/doc/api/packages/>Package API</a></li><li class=active><a href=/doc/api/misc/>Misc API</a></li></ul></li><li><a href=/doc/integrations/>Integrations</a></li></ul><div class=source-buttons><a href=/download/ class="btn btn-danger">Download</a>
<a href=https://github.com/aptly-dev/aptly class="btn btn-default">Github</a></div></div></div><div class="col-md-9 col-sm-9 col-xs-9"><h2 id=graph-api>Graph API</h2><p><code>GET /api/graph.:ext</code></p><p>Generate graph of aptly objects (same as in <a href=/doc/aptly/graph>aptly graph</a> command).</p><p><code>:ext</code> specifies desired file extension, e.g. <code>.png</code>, <code>.svg</code>.</p><p>Query params:</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>layout</code></td><td>Change between a <code>horizontal</code> (default) and a <code>vertical</code> graph layout.</td></tr></tbody></table><p>Example:</p><ul><li>open url http://localhost:8080/api/graph.svg?layout=vertical in browser (hint: aptly database should be non-empty)</li></ul><h2 id=version-api>Version API</h2><p><code>GET /api/version</code></p><p>Return current aptly version.</p><p>Example:</p><pre><code>$ curl http://localhost:8080/api/version
{&quot;Version&quot;:&quot;0.9~dev&quot;}
</code></pre><h2 id=ready-api>Ready API</h2><p><code>GET /api/ready</code></p><p>Return current readiness status of Aptly.</p><p>Example:</p><pre><code>$ curl http://localhost:8080/api/ready
{&quot;Status&quot;: &quot;Aptly is ready&quot;}
</code></pre><h2 id=healthy-api>Healthy API</h2><p><code>GET /api/healthy</code></p><p>Return current healthiness status of Aptly.</p><p>Example:</p><pre><code>$ curl http://localhost:8080/api/healthy
{&quot;Status&quot;: &quot;Aptly is healthy&quot;}
</code></pre><h2 id=metrics>Metrics</h2><p><code>GET /api/metrics</code></p><p>Disabled by default. Can be switched on by setting <code>"enableMetricsEndpoint": true</code> in the config file.</p><p>Returns aptly metrics in Prometheus format.</p><p>Provides the following metrics alongside the standard go metrics already provided by the <a href=https://pkg.go.dev/github.com/prometheus/client_golang/prometheus/promhttp>Prometheus go client library</a>:</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>aptly_api_http_request_duration_seconds</code></td><td>Duration of api requests in seconds</td></tr><tr><td><code>aptly_api_http_request_size_bytes</code></td><td>Api HTTP request size in bytes</td></tr><tr><td><code>aptly_api_http_requests_in_flight</code></td><td>Number of concurrent HTTP api requests currently handled</td></tr><tr><td><code>aptly_api_http_requests_total</code></td><td>Total number of api requests</td></tr><tr><td><code>aptly_api_http_response_size_bytes</code></td><td>Api HTTP response size in bytes</td></tr><tr><td><code>aptly_build_info</code></td><td>Versions of aptly and go</td></tr></tbody></table><p>Example (standard go metrics omitted):</p><pre><code>$ curl http://localhost:8080/api/metrics
# HELP aptly_api_files_uploaded_total Total number of uploaded files labeled by upload directory.
# TYPE aptly_api_files_uploaded_total counter
aptly_api_files_uploaded_total{directory=&quot;hello-world-0.0.1&quot;} 1

# HELP aptly_api_http_request_duration_seconds Duration of api requests in seconds.
# TYPE aptly_api_http_request_duration_seconds summary
aptly_api_http_request_duration_seconds_sum{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/files&quot;} 0.0011117079999999999
aptly_api_http_request_duration_seconds_count{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/files&quot;} 2
aptly_api_http_request_duration_seconds_sum{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/repos&quot;} 0.07773475
aptly_api_http_request_duration_seconds_count{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/repos&quot;} 2
aptly_api_http_request_duration_seconds_sum{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/version&quot;} 0.000177125
aptly_api_http_request_duration_seconds_count{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/version&quot;} 1
aptly_api_http_request_duration_seconds_sum{code=&quot;200&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 0.00064675
aptly_api_http_request_duration_seconds_count{code=&quot;200&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 1
aptly_api_http_request_duration_seconds_sum{code=&quot;400&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 0.000128833
aptly_api_http_request_duration_seconds_count{code=&quot;400&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 1

# HELP aptly_api_http_request_size_bytes Api HTTP request size in bytes.
# TYPE aptly_api_http_request_size_bytes summary
aptly_api_http_request_size_bytes_sum{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/files&quot;} 0
aptly_api_http_request_size_bytes_count{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/files&quot;} 2
aptly_api_http_request_size_bytes_sum{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/repos&quot;} 0
aptly_api_http_request_size_bytes_count{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/repos&quot;} 2
aptly_api_http_request_size_bytes_sum{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/version&quot;} 0
aptly_api_http_request_size_bytes_count{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/version&quot;} 1
aptly_api_http_request_size_bytes_sum{code=&quot;200&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 3325
aptly_api_http_request_size_bytes_count{code=&quot;200&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 1
aptly_api_http_request_size_bytes_sum{code=&quot;400&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 0
aptly_api_http_request_size_bytes_count{code=&quot;400&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 1

# HELP aptly_api_http_requests_in_flight Number of concurrent HTTP api requests currently handled.
# TYPE aptly_api_http_requests_in_flight gauge
aptly_api_http_requests_in_flight{method=&quot;GET&quot;,path=&quot;/api/files&quot;} 0
aptly_api_http_requests_in_flight{method=&quot;GET&quot;,path=&quot;/api/metrics&quot;} 1
aptly_api_http_requests_in_flight{method=&quot;GET&quot;,path=&quot;/api/repos&quot;} 0
aptly_api_http_requests_in_flight{method=&quot;GET&quot;,path=&quot;/api/version&quot;} 0
aptly_api_http_requests_in_flight{method=&quot;POST&quot;,path=&quot;/api/files&quot;} 0

# HELP aptly_api_http_requests_total Total number of api requests.
# TYPE aptly_api_http_requests_total counter
aptly_api_http_requests_total{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/files&quot;} 2
aptly_api_http_requests_total{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/repos&quot;} 2
aptly_api_http_requests_total{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/version&quot;} 1
aptly_api_http_requests_total{code=&quot;200&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 1
aptly_api_http_requests_total{code=&quot;400&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 1

# HELP aptly_api_http_response_size_bytes Api HTTP response size in bytes.
# TYPE aptly_api_http_response_size_bytes summary
aptly_api_http_response_size_bytes_sum{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/files&quot;} 74
aptly_api_http_response_size_bytes_count{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/files&quot;} 2
aptly_api_http_response_size_bytes_sum{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/repos&quot;} 188
aptly_api_http_response_size_bytes_count{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/repos&quot;} 2
aptly_api_http_response_size_bytes_sum{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/version&quot;} 21
aptly_api_http_response_size_bytes_count{code=&quot;200&quot;,method=&quot;GET&quot;,path=&quot;/api/version&quot;} 1
aptly_api_http_response_size_bytes_sum{code=&quot;200&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 51
aptly_api_http_response_size_bytes_count{code=&quot;200&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 1
aptly_api_http_response_size_bytes_sum{code=&quot;400&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 0
aptly_api_http_response_size_bytes_count{code=&quot;400&quot;,method=&quot;POST&quot;,path=&quot;/api/files&quot;} 1

# HELP aptly_build_info Metric with a constant '1' value labeled by version and goversion from which aptly was built.
# TYPE aptly_build_info gauge
aptly_build_info{goversion=&quot;go1.19.3&quot;,version=&quot;0.0.0&quot;} 1

# HELP aptly_repos_package_count Current number of published packages labeled by source, distribution and component.
# TYPE aptly_repos_package_count gauge
aptly_repos_package_count{component=&quot;main&quot;,distribution=&quot;stable&quot;,source=&quot;[foo:main]&quot;} 1

# HELP promhttp_metric_handler_requests_in_flight Current number of scrapes being served.
# TYPE promhttp_metric_handler_requests_in_flight gauge
promhttp_metric_handler_requests_in_flight 1

# HELP promhttp_metric_handler_requests_total Total number of scrapes by HTTP status code.
# TYPE promhttp_metric_handler_requests_total counter
promhttp_metric_handler_requests_total{code=&quot;200&quot;} 0
promhttp_metric_handler_requests_total{code=&quot;500&quot;} 0
promhttp_metric_handler_requests_total{code=&quot;503&quot;} 0
</code></pre></div></div></div></section><footer id=page-footer><div class=container></div></footer></body></html>