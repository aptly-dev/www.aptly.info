<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>aptly - Local Repos API</title>
<meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=/favicon.ico><link type=text/css rel=stylesheet href=/css/styles.css><link rel=canonical href=https://www.aptly.info/doc/api/repos/><link href=/post/index.xml rel=alternate type=application/rss+xml title="Debian repository management tool"></head><body><header id=page-header><div class=container><nav class="navbar navbar-default navbar-static-top" role=navigation><ul class="nav navbar-nav nav-justified"><li><a href=/tutorial/>tutorials</a></li><li><a href=/download/>download</a></li><li><a href=/support/>support</a></li><li class=active><a href=/doc/overview/>documentation</a></li><li><a href=/about/>about</a></li><li><a href=/post/>blog</a></li></ul></nav><div class=row><div class="col-md-6 col-md-offset-3 text-center"><a class=brand href=/><i class=brand-logo></i>
<span class=brand-name>aptly</span></a></div></div></div></header><section class=documentation><div class=container><div class=sidebar-overlay></div><div class=row><div class="col-md-3 col-sm-3 col-xs-3"><div class=sidebar><ul class="nav nav-sidebar"><li><a href=/doc/overview/>Overview</a></li><li><a href=/doc/why/>Why aptly?</a></li><li><a href=/doc/faq/>FAQ</a></li><li><a href=/doc/features/>Features</a><ul class=nav><li><a href=/doc/feature/query/>Package Queries</a></li><li><a href=/doc/feature/duplicate/>Duplicate Packages</a></li><li><a href=/doc/feature/s3/>Publishing to S3</a></li><li><a href=/doc/feature/swift/>Publishing to Swift</a></li><li><a href=/doc/feature/filesystem/>Filesystem Publishing</a></li><li><a href=/doc/feature/multi-component/>Multi-Component Publishing</a></li><li><a href=/doc/feature/pgp-providers/>PGP Providers</a></li><li><a href=/doc/feature/package-display/>Package Display Format</a></li><li><a href=/doc/feature/dependencies/>Dependency Resolving</a></li></ul></li><li><a href=/doc/configuration/>Configuration</a></li><li><a href=/doc/commands/>Commands</a><ul class=nav><li><a href=/doc/aptly/flags/>Global Flags</a></li><li><a href=/doc/aptly/mirror/>aptly mirror</a><ul class=nav><li><a href=/doc/aptly/mirror/create/>aptly mirror create</a></li><li><a href=/doc/aptly/mirror/update/>aptly mirror update</a></li><li><a href=/doc/aptly/mirror/list/>aptly mirror list</a></li><li><a href=/doc/aptly/mirror/show/>aptly mirror show</a></li><li><a href=/doc/aptly/mirror/edit/>aptly mirror edit</a></li><li><a href=/doc/aptly/mirror/search/>aptly mirror search</a></li><li><a href=/doc/aptly/mirror/rename/>aptly mirror rename</a></li><li><a href=/doc/aptly/mirror/drop/>aptly mirror drop</a></li></ul></li><li><a href=/doc/aptly/repo/>aptly repo</a><ul class=nav><li><a href=/doc/aptly/repo/create/>aptly repo create</a></li><li><a href=/doc/aptly/repo/add/>aptly repo add</a></li><li><a href=/doc/aptly/repo/include/>aptly repo include</a></li><li><a href=/doc/aptly/repo/import/>aptly repo import</a></li><li><a href=/doc/aptly/repo/show/>aptly repo show</a></li><li><a href=/doc/aptly/repo/list/>aptly repo list</a></li><li><a href=/doc/aptly/repo/copy/>aptly repo copy</a></li><li><a href=/doc/aptly/repo/move/>aptly repo move</a></li><li><a href=/doc/aptly/repo/remove/>aptly repo remove</a></li><li><a href=/doc/aptly/repo/search/>aptly repo search</a></li><li><a href=/doc/aptly/repo/edit/>aptly repo edit</a></li><li><a href=/doc/aptly/repo/rename/>aptly repo rename</a></li><li><a href=/doc/aptly/repo/drop/>aptly repo drop</a></li></ul></li><li><a href=/doc/aptly/snapshot/>aptly snapshot</a><ul class=nav><li><a href=/doc/aptly/snapshot/create/>aptly snapshot create</a></li><li><a href=/doc/aptly/snapshot/list/>aptly snapshot list</a></li><li><a href=/doc/aptly/snapshot/show/>aptly snapshot show</a></li><li><a href=/doc/aptly/snapshot/verify/>aptly snapshot verify</a></li><li><a href=/doc/aptly/snapshot/pull/>aptly snapshot pull</a></li><li><a href=/doc/aptly/snapshot/filter/>aptly snapshot filter</a></li><li><a href=/doc/aptly/snapshot/diff/>aptly snapshot diff</a></li><li><a href=/doc/aptly/snapshot/merge/>aptly snapshot merge</a></li><li><a href=/doc/aptly/snapshot/search/>aptly snapshot search</a></li><li><a href=/doc/aptly/snapshot/rename/>aptly snapshot rename</a></li><li><a href=/doc/aptly/snapshot/drop/>aptly snapshot drop</a></li></ul></li><li><a href=/doc/aptly/package/>aptly package</a><ul class=nav><li><a href=/doc/aptly/package/search/>aptly package search</a></li><li><a href=/doc/aptly/package/show/>aptly package show</a></li></ul></li><li><a href=/doc/aptly/publish/>aptly publish</a><ul class=nav><li><a href=/doc/aptly/publish/snapshot/>aptly publish snapshot</a></li><li><a href=/doc/aptly/publish/repo/>aptly publish repo</a></li><li><a href=/doc/aptly/publish/update/>aptly publish update</a></li><li><a href=/doc/aptly/publish/switch/>aptly publish switch</a></li><li><a href=/doc/aptly/publish/list/>aptly publish list</a></li><li><a href=/doc/aptly/publish/show/>aptly publish show</a></li><li><a href=/doc/aptly/publish/drop/>aptly publish drop</a></li></ul></li><li><a href=/doc/aptly/db/>aptly db</a><ul class=nav><li><a href=/doc/aptly/db/cleanup/>aptly db cleanup</a></li><li><a href=/doc/aptly/db/recover/>aptly db recover</a></li></ul></li><li><a href=/doc/aptly/task/>aptly task</a><ul class=nav><li><a href=/doc/aptly/task/run/>aptly task run</a></li></ul></li><li><a href=/doc/aptly/serve/>aptly serve</a></li><li><a href=/doc/aptly/config/>aptly config</a><ul class=nav><li><a href=/doc/aptly/config/show/>aptly config show</a></li></ul></li><li><a href=/doc/aptly/graph/>aptly graph</a></li></ul></li><li class=active><a href=/doc/api/>API</a><ul class=nav><li class=active><a href=/doc/api/repos/>Local Repos API</a></li><li><a href=/doc/api/mirror/>Mirrors API</a></li><li><a href=/doc/api/files/>File Upload API</a></li><li><a href=/doc/api/snapshots/>Snapshot API</a></li><li><a href=/doc/api/publish/>Publish API</a></li><li><a href=/doc/api/packages/>Package API</a></li><li><a href=/doc/api/misc/>Misc API</a></li></ul></li><li><a href=/doc/integrations/>Integrations</a></li></ul><div class=source-buttons><a href=/download/ class="btn btn-danger">Download</a>
<a href=https://github.com/aptly-dev/aptly class="btn btn-default">Github</a></div></div></div><div class="col-md-9 col-sm-9 col-xs-9"><h2 id=local-repos-api>Local Repos API</h2><p><a href=/doc/aptly/repo>Local repositories management</a> via REST API.</p><h3 id=create>Create</h3><p><code>POST /api/repos</code></p><p>Create empty local repository with specified parameters (see also <a href=/doc/aptly/repo/create>aptly repo create</a>).</p><p>JSON body params:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Name</code></td><td><em>required</em>, string</td><td>local repository name</td></tr><tr><td><code>Comment</code></td><td>string</td><td>text describing local repository, for the user</td></tr><tr><td><code>DefaultDistribution</code></td><td>string</td><td>default distribution when publishing from this local repo</td></tr><tr><td><code>DefaultComponent</code></td><td>string</td><td>default component when publishing from this local repo</td></tr></tbody></table><p>HTTP Errors:</p><table><thead><tr><th>Code</th><th>Description</th></tr></thead><tbody><tr><td>400</td><td>repository with such name already exists</td></tr></tbody></table><p>Example:</p><pre><code>$ curl -X POST -H 'Content-Type: application/json' --data '{&quot;Name&quot;: &quot;aptly-repo&quot;}' http://localhost:8080/api/repos
{&quot;Name&quot;:&quot;aptly-repo&quot;,&quot;Comment&quot;:&quot;&quot;,&quot;DefaultDistribution&quot;:&quot;&quot;,&quot;DefaultComponent&quot;:&quot;&quot;}
</code></pre><h3 id=show>Show</h3><p><code>GET /api/repos/:name</code></p><p>Returns basic information about local repository.</p><p>HTTP Errors:</p><table><thead><tr><th>Code</th><th>Description</th></tr></thead><tbody><tr><td>404</td><td>repository with such name doesn&rsquo;t exist</td></tr></tbody></table><p>Response:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Name</code></td><td>string</td><td>local repository name</td></tr><tr><td><code>Comment</code></td><td>string</td><td>text describing local repository, for the user</td></tr><tr><td><code>DefaultDistribution</code></td><td>string</td><td>default distribution when publishing from this local repo</td></tr><tr><td><code>DefaultComponent</code></td><td>string</td><td>default component when publishing from this local repo</td></tr></tbody></table><p>Example:</p><pre><code>$ curl http://localhost:8080/api/repos/aptly-repo
{&quot;Name&quot;:&quot;aptly-repo&quot;,&quot;Comment&quot;:&quot;&quot;,&quot;DefaultDistribution&quot;:&quot;&quot;,&quot;DefaultComponent&quot;:&quot;&quot;}
</code></pre><h3 id=show-packagessearch>Show packages/search</h3><p><code>GET /api/repos/:name/packages</code></p><p>List all packages in local repository or perform search on repository contents and return result.</p><p>Query params:</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>q</code></td><td><a href=/doc/feature/query>package query</a>, if missing - return all packages</td></tr><tr><td><code>withDeps</code></td><td>set to <code>1</code> to include dependencies when evaluating package query</td></tr><tr><td><code>format</code></td><td>result format, compact by default (only package keys), <code>details</code> to return full information about each package (might be slow on large repos)</td></tr></tbody></table><p>Example:</p><pre><code>$ curl http://localhost:8080/api/repos/aptly-repo/packages
[&quot;Pi386 aptly 0.8 966561016b44ed80&quot;]

$ curl http://localhost:8080/api/repos/aptly-repo/packages?q=aptly
[&quot;Pi386 aptly 0.8 966561016b44ed80&quot;]

$ curl http://localhost:8080/api/repos/aptly-repo/packages?format=details
[{&quot;Architecture&quot;:&quot;i386&quot;,&quot;Description&quot;:&quot; Debian repository management tool\n&quot;,&quot;Filename&quot;:&quot;aptly_0.8_i386.deb&quot;,&quot;FilesHash&quot;:&quot;966561016b44ed80&quot;,&quot;Homepage&quot;:&quot;http://www.aptly.info/&quot;,&quot;Installed-Size&quot;:&quot;11084&quot;,&quot;Key&quot;:&quot;Pi386 aptly 0.8 966561016b44ed80&quot;,&quot;License&quot;:&quot;MIT&quot;,&quot;MD5sum&quot;:&quot;b9be9ed873f1a05da103406cc0a6b9d1&quot;,&quot;Maintainer&quot;:&quot;Andrey Smirnov \u003cme@smira.ru\u003e&quot;,&quot;Package&quot;:&quot;aptly&quot;,&quot;Priority&quot;:&quot;extra&quot;,&quot;Recommends&quot;:&quot;bzip2&quot;,&quot;SHA1&quot;:&quot; 257ab261adcf5dd5bda800976ae606fedb882679&quot;,&quot;SHA256&quot;:&quot; 6342804c7f6bd8cb004ca9d19a7e27f492b7e07843b935a4f96a07a254ae6312&quot;,&quot;Section&quot;:&quot;default&quot;,&quot;ShortKey&quot;:&quot;Pi386 aptly 0.8&quot;,&quot;Size&quot;:&quot;3510032&quot;,&quot;Vendor&quot;:&quot;Andrey Smirnov \u003cme@smira.ru\u003e&quot;,&quot;Version&quot;:&quot;0.8&quot;}]
</code></pre><h3 id=edit>Edit</h3><p><code>PUT /api/repos/:name</code></p><p>Update local repository meta information.</p><p>JSON body params:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Comment</code></td><td>string</td><td>text describing local repository, for the user</td></tr><tr><td><code>DefaultDistribution</code></td><td>string</td><td>default distribution when publishing from this local repo</td></tr><tr><td><code>DefaultComponent</code></td><td>string</td><td>default component when publishing from this local repo</td></tr></tbody></table><p>HTTP Errors:</p><table><thead><tr><th>Code</th><th>Description</th></tr></thead><tbody><tr><td>404</td><td>repository with such name doesn&rsquo;t exist</td></tr></tbody></table><p>Response is the same as for <code>GET /api/repos/:name</code> API.</p><p>Example:</p><pre><code>$ curl -X PUT -H 'Content-Type: application/json' --data '{&quot;DefaultDistribution&quot;: &quot;trusty&quot;}' http://localhost:8080/api/repos/local1
{&quot;Name&quot;:&quot;local1&quot;,&quot;Comment&quot;:&quot;&quot;,&quot;DefaultDistribution&quot;:&quot;trusty&quot;,&quot;DefaultComponent&quot;:&quot;main&quot;}
</code></pre><h3 id=list>List</h3><p><code>GET /api/repos</code></p><p>Show list of currently available local repositories. Each repository is returned as in &ldquo;show&rdquo; API.</p><p>Example:</p><pre><code>$ curl http://localhost:8080/api/repos
[{&quot;Name&quot;:&quot;aptly-repo&quot;,&quot;Comment&quot;:&quot;&quot;,&quot;DefaultDistribution&quot;:&quot;&quot;,&quot;DefaultComponent&quot;:&quot;&quot;}]
</code></pre><h3 id=delete>Delete</h3><p><code>DELETE /api/repos/:name</code></p><p>Delete local repository.</p><p>Local repository can&rsquo;t be deleted if it is published. If local repository has snapshots, aptly would refuse
to delete it by default, but that can be overridden with <code>force</code> flag.</p><p>Query params:</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>force</code></td><td>when value is set to <code>1</code>, delete local repository even if it has snapshots</td></tr></tbody></table><p>HTTP Errors:</p><table><thead><tr><th>Code</th><th>Description</th></tr></thead><tbody><tr><td>404</td><td>repository with such name doesn&rsquo;t exist</td></tr><tr><td>409</td><td>repository can&rsquo;t be dropped (reason in the message)</td></tr></tbody></table><h3 id=add-packages-from-uploaded-filedirectory>Add packages from uploaded file/directory</h3><p><code>POST /api/repos/:name/file/:dir</code></p><p><code>POST /api/repos/:name/file/:dir/:file</code></p><p>Import packages from files (uploaded using <a href=/doc/api/files>File Upload API</a>) to the local repository. If directory
specified, aptly would discover package files automatically.</p><p>Adding same package to local repository is not an error.</p><p>By default aptly would try to remove every successfully processed file and directory <code>:dir</code> (if it becomes empty
after import).</p><p>Query params:</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>noRemove</code></td><td>when value is set to <code>1</code>, don&rsquo;t remove any files</td></tr><tr><td><code>forceReplace</code></td><td>when value is set to <code>1</code>, remove packages conflicting with package being added (in local repository)</td></tr></tbody></table><p>HTTP Errors:</p><table><thead><tr><th>Code</th><th>Description</th></tr></thead><tbody><tr><td>404</td><td>repository with such name doesn&rsquo;t exist</td></tr></tbody></table><p>Response:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>FailedFiles</code></td><td>[]string</td><td>list of files that failed to be processed</td></tr><tr><td><code>Report</code></td><td>object</td><td>operation report (see below)</td></tr></tbody></table><p>Report structure:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Warnings</code></td><td>[]string</td><td>list of warnings</td></tr><tr><td><code>Added</code></td><td>[]string</td><td>list of messages related to packages being added</td></tr><tr><td><code>Deleted</code></td><td>[]string</td><td>list of messages related to packages being deleted</td></tr></tbody></table><p>Example (file upload, add package to repo):</p><pre><code>$ curl -X POST -F file=@aptly_0.9~dev+217+ge5d646c_i386.deb http://localhost:8080/api/files/aptly-0.9
[&quot;aptly-0.9/aptly_0.9~dev+217+ge5d646c_i386.deb&quot;]

$ curl -X POST http://localhost:8080/api/repos/repo1/file/aptly-0.9
{&quot;FailedFiles&quot;:[],&quot;Report&quot;:{&quot;Warnings&quot;:[],&quot;Added&quot;:[&quot;aptly_0.9~dev+217+ge5d646c_i386 added&quot;],&quot;Removed&quot;:[]}}
</code></pre><h3 id=include-packages-from-uploaded-filedirectory>Include packages from uploaded file/directory</h3><p><code>POST /api/repos/:name/include/:dir</code></p><p><code>POST /api/repos/:name/include/:dir/:file</code></p><p>New in <span class="label label-primary">1.4.0</span></p><p>Allows automatic processing of <code>.changes</code> file controlling package upload (uploaded using <a href=/doc/api/files>File Upload API</a>) to the local repository. Exposes <a href=/doc/aptly/repo/include>repo include</a> command in api.</p><p>Query params:</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><code>noRemoveFiles</code></td><td>when value is set to <code>1</code>, donâ€™t remove files that have been imported successfully into repository</td></tr><tr><td><code>forceReplace</code></td><td>when value is set to <code>1</code>, when adding package that conflicts with existing package, remove existing package</td></tr><tr><td><code>ignoreSignature</code></td><td>when value is set to <code>1</code> disable verification of .changes file signature</td></tr><tr><td><code>acceptUnsigned</code></td><td>when value is set to <code>1</code> accept unsigned .changes files</td></tr></tbody></table><p>Response:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>FailedFiles</code></td><td>[]string</td><td>list of files that failed to be processed</td></tr><tr><td><code>Report</code></td><td>object</td><td>operation report (see below)</td></tr></tbody></table><p>Report structure:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Warnings</code></td><td>[]string</td><td>list of warnings</td></tr><tr><td><code>Added</code></td><td>[]string</td><td>list of messages related to packages being added</td></tr><tr><td><code>Deleted</code></td><td>[]string</td><td>list of messages related to packages being deleted</td></tr></tbody></table><p>Example (file upload, include changes files in repo):</p><pre><code>$ curl -X POST -F file=@hardlink_0.2.1_amd64.changes http://localhost:8080/api/files/hardlink
[&quot;file=@hardlink_0.2.1_amd64.changes&quot;]

$ # upload any other files referenced in .changes file...

$ curl -X POST http://localhost:8080/api/repos/repo1/include/hardlink
{&quot;FailedFiles&quot;:[],&quot;Report&quot;:{&quot;Warnings&quot;:[],&quot;Added&quot;:[&quot;hardlink_0.2.1_source added&quot;],&quot;Removed&quot;:[]}}
</code></pre><h3 id=add-packages-by-key>Add packages by key</h3><p><code>POST /api/repos/:name/packages</code></p><p>Add packages to local repository by package keys.</p><p>Any package could be added, it should be part of aptly database (it could come from any mirror, snapshot, other
local repository). This API combined with package list (search) APIs allows to implement importing, copying,
moving packages around.</p><p>API verifies that packages actually exist in aptly database and checks constraint that conflicting packages
can&rsquo;t be part of the same local repository.</p><p>JSON body params:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>PackageRefs</code></td><td>[]string</td><td>list of package references (package keys)</td></tr></tbody></table><p>HTTP Errors:</p><table><thead><tr><th>Code</th><th>Description</th></tr></thead><tbody><tr><td>400</td><td>added package conflicts with already exists in repository</td></tr><tr><td>404</td><td>repository with such name doesn&rsquo;t exist</td></tr><tr><td>404</td><td>package with specified key doesn&rsquo;t exist</td></tr></tbody></table><p>Response is the same as for <code>GET /api/repos/:name</code> API.</p><p>Example:</p><pre><code>$ curl -X POST -H 'Content-Type: application/json' --data '{&quot;PackageRefs&quot;: [&quot;Psource pyspi 0.6.1-1.4 f8f1daa806004e89&quot;,&quot;Pi386 libboost-program-options-dev 1.49.0.1 918d2f433384e378&quot;]}' http://localhost:8080/api/repos/repo2/packages
{&quot;Name&quot;:&quot;repo2&quot;,&quot;Comment&quot;:&quot;&quot;,&quot;DefaultDistribution&quot;:&quot;&quot;,&quot;DefaultComponent&quot;:&quot;main&quot;}
</code></pre><h3 id=delete-packages-by-key>Delete packages by key</h3><p><code>DELETE /api/repos/:name/packages</code></p><p>Remove packages from local repository by package keys.</p><p>Any package(s) could be removed from local repository. List package references
in local repository could be retrieved with <code>GET /repos/:name/packages</code>.</p><p>JSON body params:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>PackageRefs</code></td><td>[]string</td><td>list of package references (package keys)</td></tr></tbody></table><p>HTTP Errors:</p><table><thead><tr><th>Code</th><th>Description</th></tr></thead><tbody><tr><td>404</td><td>repository with such name doesn&rsquo;t exist</td></tr></tbody></table><p>Response is the same as for <code>GET /api/repos/:name</code> API.</p><p>Example:</p><pre><code>$ curl -X DELETE -H 'Content-Type: application/json' --data '{&quot;PackageRefs&quot;: [&quot;Pi386 libboost-program-options-dev 1.49.0.1 918d2f433384e378&quot;]}' http://localhost:8080/api/repos/repo2/packages
{&quot;Name&quot;:&quot;repo2&quot;,&quot;Comment&quot;:&quot;&quot;,&quot;DefaultDistribution&quot;:&quot;&quot;,&quot;DefaultComponent&quot;:&quot;main&quot;}
</code></pre></div></div></div></section><footer id=page-footer><div class=container><nav class="navbar navbar-default navbar-static-top" role=navigation><ul class="nav navbar-nav nav-justified"><li><a href=/tutorial/>tutorials</a></li><li><a href=/download/>download</a></li><li><a href=/support/>support</a></li><li class=active><a href=/doc/overview/>documentation</a></li><li><a href=/about/>about</a></li><li><a href=/post/>blog</a></li></ul></nav></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/aptly.js></script></body></html>