<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>aptly - aptly mirror create</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=/favicon.ico><link type=text/css rel=stylesheet href=/css/styles.css><link rel=canonical href=https://www.aptly.info/doc/aptly/mirror/create/><link href=/post/index.xml rel=alternate type=application/rss+xml title="Debian repository management tool"></head><body><header id=page-header><div class=container><nav class="navbar navbar-default navbar-static-top" role=navigation><ul class="nav navbar-nav nav-justified"><li><a href=/tutorial/>tutorials</a></li><li><a href=/download/>download</a></li><li><a href=/support/>support</a></li><li class=active><a href=/doc/overview/>documentation</a></li><li><a href=/about/>about</a></li><li><a href=/post/>blog</a></li></ul></nav><div class=row><div class="col-md-6 col-md-offset-3 text-center"><a class=brand href=/><i class=brand-logo></i>
<span class=brand-name>aptly</span></a></div></div></div></header><section class=documentation><div class=container><div class=sidebar-overlay></div><div class=row><div class="col-md-3 col-sm-3 col-xs-3"><div class=sidebar><ul class="nav nav-sidebar"><li><a href=/doc/overview/>Overview</a></li><li><a href=/doc/why/>Why aptly?</a></li><li><a href=/doc/faq/>FAQ</a></li><li><a href=/doc/features/>Features</a><ul class=nav><li><a href=/doc/feature/query/>Package Queries</a></li><li><a href=/doc/feature/duplicate/>Duplicate Packages</a></li><li><a href=/doc/feature/s3/>Publishing to S3</a></li><li><a href=/doc/feature/swift/>Publishing to Swift</a></li><li><a href=/doc/feature/filesystem/>Filesystem Publishing</a></li><li><a href=/doc/feature/multi-component/>Multi-Component Publishing</a></li><li><a href=/doc/feature/pgp-providers/>PGP Providers</a></li><li><a href=/doc/feature/package-display/>Package Display Format</a></li><li><a href=/doc/feature/dependencies/>Dependency Resolving</a></li></ul></li><li><a href=/doc/configuration/>Configuration</a></li><li class=active><a href=/doc/commands/>Commands</a><ul class=nav><li><a href=/doc/aptly/flags/>Global Flags</a></li><li class=active><a href=/doc/aptly/mirror/>aptly mirror</a><ul class=nav><li class=active><a href=/doc/aptly/mirror/create/>aptly mirror create</a></li><li><a href=/doc/aptly/mirror/update/>aptly mirror update</a></li><li><a href=/doc/aptly/mirror/list/>aptly mirror list</a></li><li><a href=/doc/aptly/mirror/show/>aptly mirror show</a></li><li><a href=/doc/aptly/mirror/edit/>aptly mirror edit</a></li><li><a href=/doc/aptly/mirror/search/>aptly mirror search</a></li><li><a href=/doc/aptly/mirror/rename/>aptly mirror rename</a></li><li><a href=/doc/aptly/mirror/drop/>aptly mirror drop</a></li></ul></li><li><a href=/doc/aptly/repo/>aptly repo</a><ul class=nav><li><a href=/doc/aptly/repo/create/>aptly repo create</a></li><li><a href=/doc/aptly/repo/add/>aptly repo add</a></li><li><a href=/doc/aptly/repo/include/>aptly repo include</a></li><li><a href=/doc/aptly/repo/import/>aptly repo import</a></li><li><a href=/doc/aptly/repo/show/>aptly repo show</a></li><li><a href=/doc/aptly/repo/list/>aptly repo list</a></li><li><a href=/doc/aptly/repo/copy/>aptly repo copy</a></li><li><a href=/doc/aptly/repo/move/>aptly repo move</a></li><li><a href=/doc/aptly/repo/remove/>aptly repo remove</a></li><li><a href=/doc/aptly/repo/search/>aptly repo search</a></li><li><a href=/doc/aptly/repo/edit/>aptly repo edit</a></li><li><a href=/doc/aptly/repo/rename/>aptly repo rename</a></li><li><a href=/doc/aptly/repo/drop/>aptly repo drop</a></li></ul></li><li><a href=/doc/aptly/snapshot/>aptly snapshot</a><ul class=nav><li><a href=/doc/aptly/snapshot/create/>aptly snapshot create</a></li><li><a href=/doc/aptly/snapshot/list/>aptly snapshot list</a></li><li><a href=/doc/aptly/snapshot/show/>aptly snapshot show</a></li><li><a href=/doc/aptly/snapshot/verify/>aptly snapshot verify</a></li><li><a href=/doc/aptly/snapshot/pull/>aptly snapshot pull</a></li><li><a href=/doc/aptly/snapshot/filter/>aptly snapshot filter</a></li><li><a href=/doc/aptly/snapshot/diff/>aptly snapshot diff</a></li><li><a href=/doc/aptly/snapshot/merge/>aptly snapshot merge</a></li><li><a href=/doc/aptly/snapshot/search/>aptly snapshot search</a></li><li><a href=/doc/aptly/snapshot/rename/>aptly snapshot rename</a></li><li><a href=/doc/aptly/snapshot/drop/>aptly snapshot drop</a></li></ul></li><li><a href=/doc/aptly/package/>aptly package</a><ul class=nav><li><a href=/doc/aptly/package/search/>aptly package search</a></li><li><a href=/doc/aptly/package/show/>aptly package show</a></li></ul></li><li><a href=/doc/aptly/publish/>aptly publish</a><ul class=nav><li><a href=/doc/aptly/publish/snapshot/>aptly publish snapshot</a></li><li><a href=/doc/aptly/publish/repo/>aptly publish repo</a></li><li><a href=/doc/aptly/publish/update/>aptly publish update</a></li><li><a href=/doc/aptly/publish/switch/>aptly publish switch</a></li><li><a href=/doc/aptly/publish/list/>aptly publish list</a></li><li><a href=/doc/aptly/publish/show/>aptly publish show</a></li><li><a href=/doc/aptly/publish/drop/>aptly publish drop</a></li></ul></li><li><a href=/doc/aptly/db/>aptly db</a><ul class=nav><li><a href=/doc/aptly/db/cleanup/>aptly db cleanup</a></li><li><a href=/doc/aptly/db/recover/>aptly db recover</a></li></ul></li><li><a href=/doc/aptly/task/>aptly task</a><ul class=nav><li><a href=/doc/aptly/task/run/>aptly task run</a></li></ul></li><li><a href=/doc/aptly/serve/>aptly serve</a></li><li><a href=/doc/aptly/config/>aptly config</a><ul class=nav><li><a href=/doc/aptly/config/show/>aptly config show</a></li></ul></li><li><a href=/doc/aptly/graph/>aptly graph</a></li></ul></li><li><a href=/doc/api/>API</a><ul class=nav><li><a href=/doc/api/repos/>Local Repos API</a></li><li><a href=/doc/api/mirror/>Mirrors API</a></li><li><a href=/doc/api/files/>File Upload API</a></li><li><a href=/doc/api/snapshots/>Snapshot API</a></li><li><a href=/doc/api/publish/>Publish API</a></li><li><a href=/doc/api/packages/>Package API</a></li><li><a href=/doc/api/misc/>Misc API</a></li></ul></li><li><a href=/doc/integrations/>Integrations</a></li></ul><div class=source-buttons><a href=/download/ class="btn btn-danger">Download</a>
<a href=https://github.com/aptly-dev/aptly class="btn btn-default">Github</a></div></div></div><div class="col-md-9 col-sm-9 col-xs-9"><h2 id=aptly-mirror-create>aptly mirror create</h2><p>Creates mirror of remote repository, aptly supports both regular and
flat Debian repositories exported via HTTP(S) or FTP. aptly would try download
Release file from remote repository and verify its signature.</p><p>Usage:</p><pre><code>$  aptly mirror create &lt;name&gt; &lt;archive url&gt; &lt;distribution&gt; [&lt;component1&gt; ...]
</code></pre><p>For Launchpad PPAs:</p><pre><code>$  aptly mirror create &lt;name&gt; &lt;ppa:user/project&gt;
</code></pre><p>Params are:</p><ul><li><code>name</code> is a name that would be used in aptly to reference this
mirror</li><li><code>archive url</code> is a root of archive, e.g.
<a href=http://ftp.ru.debian.org/debian/>http://ftp.ru.debian.org/debian/</a></li><li><code>distribution</code> is a distribution name, e.g. <code>squeeze</code>, for flat
repositories use <code>./</code> instead of distribution name</li><li><code>component1</code> is an optional list of components to download, if not
specified aptly would fetch all components.</li></ul><p>Flags:</p><ul><li><code>-filter=</code>: <a href=/doc/feature/query/>package query</a> that is applied to
packages in the mirror</li><li><code>-filter-with-deps</code>: when filtering, include <a href=/doc/feature/dependencies>dependencies</a> of
matching packages as well</li><li><code>-force-components</code>: (only with component list on command line)
skip check that requested components are listed in <code>Release</code> file</li><li><code>-ignore-signatures</code>: disable verification of <code>Release</code> file
signatures</li><li><code>-keyring=trustedkeys.gpg</code>: gpg keyring to use when verifying
Release file (could be specified multiple times)</li><li><code>-with-installer</code>: download additional not packaged installer
files <span class="label label-primary">1.4.0</span></li><li><code>-with-sources</code>: download source packages in addition to
binary packages (could be enabled by default with config option
<code>downloadSourcePackages</code>)</li><li><code>-with-udebs</code>: download .udeb packages (Debian installer
support)</li></ul><p>By default aptly would download packages for all available
architectures. If architectures are limited (with config <code>architectures</code>
or option <code>-architectures</code>), only packages for those architectures are
downloaded.</p><p>If components are not specified, aptly will download packages from all
components and merge them into one. If components should
be left separate, please create <a href=/doc/feature/multi-component/>separate mirror for each component</a>.</p><p>If PPA url is specified, aptly would expand it to HTTP url using
configuration options <code>ppaDistributorID</code> & <code>ppaCodename</code>. If you&rsquo;re
running aptly on Ubuntu, defaults should work (aptly would figure out
codename using <code>lsb_release</code> command).</p><p>If filtering is enabled, all package lists are downloaded and filters
are applied to those lists. Only packages that match filter query would
be downloaded and filtered list would be stored as contents of the mirror. If
dependency following is enabled, dependencies would be expanded in
filtered list to build resulting package list. Filters could be used to
limit mirror to only one package and its dependencies
(<code>-filter='nginx' -filter-follow-deps</code>), download only high-priority
packages (<code>-filter='Priority (required)'</code>) and so on.</p><p>aptly would try to verify signature of Release files using GnuPG. By
default, keyring <code>~/.gnupg/trustedkeys.gpg</code> would be used. If you would
like to use different keyring(s), specify them using <code>-keyring</code> flag.
aptly would advise <code>gpg</code> commands to import keys into trusted keys
keyring in order to successfully verify repository signature.</p><p>If aptly is running on Debian/Ubuntu machine, it would be good idea to import
archive signing keys shipped with the operating system:</p><pre><code>$ gpg --no-default-keyring --keyring /usr/share/keyrings/debian-archive-keyring.gpg --export | gpg --no-default-keyring --keyring trustedkeys.gpg --import
</code></pre><p>If you&rsquo;re running Ubuntu, use
<code>/usr/share/keyrings/ubuntu-archive-keyring.gpg</code></p><p>If GnuPG is complaining that required key to verify signature is
missing, it would report key ID, e.g. <code>46925553</code>. Keys could be
downloaded from public keyserver and imported into trusted keyring using
command:</p><pre><code>$ gpg --no-default-keyring --keyring trustedkeys.gpg --keyserver keys.gnupg.net --recv-keys 46925553
</code></pre><p>Replace <code>46925553</code> with the key ID GnuPG is complaining about.</p><p>If you&rsquo;re mirroring flat repository, sometimes repository key is located
near release files, so you can download it and import into your trusted
keychain:</p><pre><code>$ wget -O - https://some.repo/repository/Release.key | gpg --no-default-keyring --keyring trustedkeys.gpg --import
</code></pre><p>You can learn about signed Debian repositories in <a href=https://wiki.debian.org/SecureApt>Debian wiki</a>.
If you would like to disable signature checks, you can use flag <code>-ignore-signatures</code> or configuration
setting <code>gpgDisableVerify</code>.</p><p>aptly deduplicates all downloaded files, so if two mirrors are created
one with source packages enabled and another with source packages
disabled, they would consume only space required to store all binary and
source packages (not twice the space required to store binary packages).</p><p>Example:</p><pre><code>$ aptly -architectures=&quot;amd64&quot; mirror create debian-main http://ftp.ru.debian.org/debian/ squeeze main
2013/12/28 19:44:45 Downloading http://ftp.ru.debian.org/debian/dists/squeeze/Release...
...

Mirror [debian-main]: http://ftp.ru.debian.org/debian/ squeeze successfully added.
You can run 'aptly mirror update debian-main' to download repository contents.
</code></pre><p>For newly created mirror, <a href=/doc/aptly/mirror/update/><code>aptly mirror update</code></a> should be run
to download mirror contents for the first time.</p></div></div></div></section><footer id=page-footer><div class=container><nav class="navbar navbar-default navbar-static-top" role=navigation><ul class="nav navbar-nav nav-justified"><li><a href=/tutorial/>tutorials</a></li><li><a href=/download/>download</a></li><li><a href=/support/>support</a></li><li class=active><a href=/doc/overview/>documentation</a></li><li><a href=/about/>about</a></li><li><a href=/post/>blog</a></li></ul></nav></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/aptly.js></script></body></html>