<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>aptly - Dependency Resolving</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=/favicon.ico><link type=text/css rel=stylesheet href=/css/styles.css><link type=text/css rel=stylesheet href=/swagger-ui/swagger-ui.css><link type=text/css rel=stylesheet href=/css/api.css><link rel=canonical href=https://www.aptly.info/doc/feature/dependencies/><link href=/post/index.xml rel=alternate type=application/rss+xml title="Debian repository management tool"></head><body><header id=page-header><div class=container><div style=display:flex;align-items:end><div class=text-center style=font-size:9px><a class=brand href=/><i class=brand-logo></i>
<span class=brand-name>aptly</span></a></div><div style=flex-grow:1><nav class="navbar navbar-default navbar-static-top" role=navigation><ul class="nav navbar-nav nav-justified"><li><a href=/tutorial/>tutorials</a></li><li><a href=/download/>download</a></li><li><a href=/support/>support</a></li><li class=active><a href=/doc/overview/>documentation</a></li><li><a href=/about/>about</a></li><li><a href=/post/>blog</a></li></ul></nav></div></div></div><div class=container></div></header><script src=/swagger-ui/swagger-ui-bundle.js></script><script src=/swagger-ui/swagger-ui-standalone-preset.js></script><section class=documentation><div class=container><div class=sidebar-overlay></div><div class=row><div class="col-md-3 col-sm-3 col-xs-3"><div class=sidebar><ul class="nav nav-sidebar"><li><a href=/doc/overview/>Overview</a></li><li><a href=/doc/why/>Why aptly?</a></li><li><a href=/doc/faq/>FAQ</a></li><li class=active><a href=/doc/features/>Features</a><ul class=nav><li><a href=/doc/feature/query/>Package Queries</a></li><li><a href=/doc/feature/duplicate/>Duplicate Packages</a></li><li><a href=/doc/feature/s3/>Publishing to S3</a></li><li><a href=/doc/feature/swift/>Publishing to Swift</a></li><li><a href=/doc/feature/filesystem/>Filesystem Publishing</a></li><li><a href=/doc/feature/multi-component/>Multi-Component Publishing</a></li><li><a href=/doc/feature/pgp-providers/>PGP Providers</a></li><li><a href=/doc/feature/package-display/>Package Display Format</a></li><li class=active><a href=/doc/feature/dependencies/>Dependency Resolving</a></li></ul></li><li><a href=/doc/configuration/>Configuration</a></li><li><a href=/doc/commands/>Commands</a><ul class=nav><li><a href=/doc/aptly/flags/>Global Flags</a></li><li><a href=/doc/aptly/mirror/>aptly mirror</a><ul class=nav><li><a href=/doc/aptly/mirror/create/>aptly mirror create</a></li><li><a href=/doc/aptly/mirror/update/>aptly mirror update</a></li><li><a href=/doc/aptly/mirror/list/>aptly mirror list</a></li><li><a href=/doc/aptly/mirror/show/>aptly mirror show</a></li><li><a href=/doc/aptly/mirror/edit/>aptly mirror edit</a></li><li><a href=/doc/aptly/mirror/search/>aptly mirror search</a></li><li><a href=/doc/aptly/mirror/rename/>aptly mirror rename</a></li><li><a href=/doc/aptly/mirror/drop/>aptly mirror drop</a></li></ul></li><li><a href=/doc/aptly/repo/>aptly repo</a><ul class=nav><li><a href=/doc/aptly/repo/create/>aptly repo create</a></li><li><a href=/doc/aptly/repo/add/>aptly repo add</a></li><li><a href=/doc/aptly/repo/include/>aptly repo include</a></li><li><a href=/doc/aptly/repo/import/>aptly repo import</a></li><li><a href=/doc/aptly/repo/show/>aptly repo show</a></li><li><a href=/doc/aptly/repo/list/>aptly repo list</a></li><li><a href=/doc/aptly/repo/copy/>aptly repo copy</a></li><li><a href=/doc/aptly/repo/move/>aptly repo move</a></li><li><a href=/doc/aptly/repo/remove/>aptly repo remove</a></li><li><a href=/doc/aptly/repo/search/>aptly repo search</a></li><li><a href=/doc/aptly/repo/edit/>aptly repo edit</a></li><li><a href=/doc/aptly/repo/rename/>aptly repo rename</a></li><li><a href=/doc/aptly/repo/drop/>aptly repo drop</a></li></ul></li><li><a href=/doc/aptly/snapshot/>aptly snapshot</a><ul class=nav><li><a href=/doc/aptly/snapshot/create/>aptly snapshot create</a></li><li><a href=/doc/aptly/snapshot/list/>aptly snapshot list</a></li><li><a href=/doc/aptly/snapshot/show/>aptly snapshot show</a></li><li><a href=/doc/aptly/snapshot/verify/>aptly snapshot verify</a></li><li><a href=/doc/aptly/snapshot/pull/>aptly snapshot pull</a></li><li><a href=/doc/aptly/snapshot/filter/>aptly snapshot filter</a></li><li><a href=/doc/aptly/snapshot/diff/>aptly snapshot diff</a></li><li><a href=/doc/aptly/snapshot/merge/>aptly snapshot merge</a></li><li><a href=/doc/aptly/snapshot/search/>aptly snapshot search</a></li><li><a href=/doc/aptly/snapshot/rename/>aptly snapshot rename</a></li><li><a href=/doc/aptly/snapshot/drop/>aptly snapshot drop</a></li></ul></li><li><a href=/doc/aptly/package/>aptly package</a><ul class=nav><li><a href=/doc/aptly/package/search/>aptly package search</a></li><li><a href=/doc/aptly/package/show/>aptly package show</a></li></ul></li><li><a href=/doc/aptly/publish/>aptly publish</a><ul class=nav><li><a href=/doc/aptly/publish/snapshot/>aptly publish snapshot</a></li><li><a href=/doc/aptly/publish/repo/>aptly publish repo</a></li><li><a href=/doc/aptly/publish/update/>aptly publish update</a></li><li><a href=/doc/aptly/publish/switch/>aptly publish switch</a></li><li><a href=/doc/aptly/publish/list/>aptly publish list</a></li><li><a href=/doc/aptly/publish/show/>aptly publish show</a></li><li><a href=/doc/aptly/publish/drop/>aptly publish drop</a></li></ul></li><li><a href=/doc/aptly/db/>aptly db</a><ul class=nav><li><a href=/doc/aptly/db/cleanup/>aptly db cleanup</a></li><li><a href=/doc/aptly/db/recover/>aptly db recover</a></li></ul></li><li><a href=/doc/aptly/task/>aptly task</a><ul class=nav><li><a href=/doc/aptly/task/run/>aptly task run</a></li></ul></li><li><a href=/doc/aptly/serve/>aptly serve</a></li><li><a href=/doc/aptly/config/>aptly config</a><ul class=nav><li><a href=/doc/aptly/config/show/>aptly config show</a></li></ul></li><li><a href=/doc/aptly/graph/>aptly graph</a></li></ul></li><li><a href=/doc/api/swagger/>REST API Documentation</a></li><li><a href=/doc/api/>Legacy API</a><ul class=nav><li><a href=/doc/api/repos/>Local Repos API</a></li><li><a href=/doc/api/mirror/>Mirrors API</a></li><li><a href=/doc/api/files/>File Upload API</a></li><li><a href=/doc/api/snapshots/>Snapshot API</a></li><li><a href=/doc/api/publish/>Publish API</a></li><li><a href=/doc/api/packages/>Package API</a></li><li><a href=/doc/api/misc/>Misc API</a></li></ul></li><li><a href=/doc/integrations/>Integrations</a></li></ul><div class=source-buttons><a href=/download/ class="btn btn-danger">Download</a>
<a href=https://github.com/aptly-dev/aptly class="btn btn-default">Github</a></div></div></div><div class="col-md-9 col-sm-9 col-xs-9"><h2 id=dependency-resolving>Dependency Resolving</h2><p>aptly supports automatic recursive resolving of package dependencies. For example, given set
of packages <code>pkg-a</code> and <code>pkg-b</code> aptly can figure out all the package dependencies and pull them
with the packages. This allows to pull <code>Depends:</code> (including <code>Pre-Depends:</code>), <code>Recommends:</code>, source
packages and so on.</p><p>Command <a href=/doc/aptly/snapshot/pull>aptly snapshot pull</a> was the first one to support dependency resolving
(it is enabled by default in this command). The best example is
<a href=/tutorial/pull>pulling selected packages from backports repos with dependencies, overriding packages in base distribution</a>.</p><p>All the commands which accept <a href=/doc/feature/query>package query</a> as parameter (this includes family of
<code>aptly * search</code> commands, various <code>copy</code>, <code>move</code> commands), apply filter to the source matching only specified
packages. But if <code>-with-deps</code> flag is set, aptly resolves dependencies of packages matching the filter expanding
matching packages with all the available dependencies. This allows for example to search for package with all its
dependencies.</p><p>Command <a href=/doc/aptly/mirror/update>aptly mirror update</a> also supports package filters set either when mirror is
<a href=/doc/aptly/mirror/create>created</a> or <a href=/doc/aptly/mirror/edit>modified</a>. This allows to cut down download size
dramatically by selecting only subset of the available packages.</p><p>Overall, aptly dependency resolution is not that robust as <code>apt-get</code> one, but it should work fine in the most cases.
When filtering complete Debian distributions, it&rsquo;s advised to always pick up <code>Priority (Required)</code> or
<code>Priority (Important)</code> packages
(<a href=https://www.debian.org/doc/manuals/debian-faq/ch-pkg_basics.en.html#s-priority>what is that?</a>) as a basis to resolve
dependencies against.</p><h3 id=options>Options</h3><p>Several options affect dependency resolving process. They might be set either in the <a href=/doc/configuration>configuration file</a> or
passed via <a href=/doc/aptly/flags>command-line flags</a>. If passed via flags, they should be passed to the command which executes
dependency resolution algorithm each time command is run (e.g. mirror filter is set with <a href=/doc/aptly/mirror/create>aptly mirror create</a>,
but filter is applied in <a href=/doc/aptly/mirror/update>aptly mirror update</a>, so dependency flags should be passed to
<code>aptly mirror update</code> command).</p><p>By default, aptly only follows dependencies in <code>Depends:</code> and <code>Pre-Depends:</code> fields, flags <code>-dep-follow-recommends</code> and
<code>-dep-follow-suggests</code> expand that to <code>Recommens:</code> and <code>Suggests</code> fields. When <code>-dep-follow-source</code> flag is set, aptly
pulls source packages for each binary package selected.</p><p>When <code>-dep-follow-all-variants</code> is enabled, aptly follows all the paths for dependencies to grab all the available
dependent packages. For example, if <code>pkg-a</code> depends on either <code>pkg-b</code> or <code>pkg-c</code>, by default aptly will pick one of
<code>pkg-b</code> or <code>pkg-c</code>, but with <code>-dep-follow-all-variants</code> aptly would pick up both packages. Same applies to virtual packages,
all the package which provide the feature would be selected.</p><h3 id=verbose-logging>Verbose Logging</h3><p>New in <span class="label label-primary">1.1.0</span>
.</p><p>When global flag <code>-dep-verbose-resolve</code> is set (or respective configuration option is enabled), aptly prints
detailed log while resolving dependencies:</p><pre><code>Missing dependencies: file-rc (&gt;= 0.8.16) [amd64], python:any (&gt;= 2.7.1-0ubuntu2) [amd64], python3:any (&gt;= 3.3.2-2~) [amd64], file-rc [amd64], perl (&lt;&lt; 5.17) [amd64], iptables-router (&gt;= 1.2.3) [amd64], systemd [amd64], sgml-base (&gt;= 1.26+nmu2) [amd64], sed (&gt;= 4.1.2-8) [amd64]
Unsatisfied dependency: file-rc (&gt;= 0.8.16) [amd64]
Unsatisfied dependency: python:any (&gt;= 2.7.1-0ubuntu2) [amd64]
Unsatisfied dependency: python3:any (&gt;= 3.3.2-2~) [amd64]
Unsatisfied dependency: file-rc [amd64]
Unsatisfied dependency: perl (&lt;&lt; 5.17) [amd64]
Unsatisfied dependency: iptables-router (&gt;= 1.2.3) [amd64]
Unsatisfied dependency: systemd [amd64]
Injecting package: sgml-base_1.26+nmu4ubuntu1_all
Injecting package: sed_4.2.2-4ubuntu1_amd64
</code></pre><p>Dependency resolving process goes through several steps in a loop, exiting the loop once it&rsquo;s not possible to inject any
new dependency:</p><ol><li>Scan all the packages in the list, collect all the dependencies (<code>Missing dependencies</code>)</li><li>For each dependency, find package (or packages) which might satisfy dependency. If such package
is not available, <code>Unsatisfied dependency:</code> message is printed.</li><li>Add packages to the set which satisfy some of the dependencies (<code>Injecting package:</code>)</li><li>If any packages were added on step 3, repeat from step 1, otherwise finish dependency resolving.</li></ol></div></div></div></section><footer id=page-footer><div class=container></div></footer></body></html>