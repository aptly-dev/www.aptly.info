<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>aptly - Package Queries</title><meta name=viewport content="width=device-width,initial-scale=1">
<link rel="shortcut icon" href=/www.aptly.info/favicon.ico>
<link type=text/css rel=stylesheet href=/www.aptly.info/css/styles.css>
<link rel=canonical href=http://aptly-dev.github.io/www.aptly.info/doc/feature/query/>
<link href=/www.aptly.info/post/index.xml rel=alternate type=application/rss+xml title="Debian repository management tool">
</head><body>
<header id=page-header>
<div class=container>
<nav class="navbar navbar-default navbar-static-top" role=navigation>
<ul class="nav navbar-nav nav-justified">
<li><a href=/www.aptly.info/tutorial/>tutorials</a></li><li><a href=/www.aptly.info/download/>download</a></li><li><a href=/www.aptly.info/support/>support</a></li><li class=active><a href=/www.aptly.info/doc/overview/>documentation</a></li><li><a href=/www.aptly.info/about/>about</a></li><li><a href=/www.aptly.info/post/>blog</a></li></ul></nav><div class=row>
<div class="col-md-6 col-md-offset-3 text-center">
<a class=brand href=/www.aptly.info/>
<i class=brand-logo></i>
<span class=brand-name>aptly</span>
</a>
</div></div></div></header><section class=documentation>
<div class=container>
<div class=sidebar-overlay></div><div class=row>
<div class="col-md-3 col-sm-3 col-xs-3">
<div class=sidebar>
<ul class="nav nav-sidebar">
<li>
<a href=/www.aptly.info/doc/overview/>Overview</a>
</li><li>
<a href=/www.aptly.info/doc/why/>Why aptly?</a>
</li><li>
<a href=/www.aptly.info/doc/faq/>FAQ</a>
</li><li class=active>
<a href=/www.aptly.info/doc/features/>Features</a>
<ul class=nav>
<li class=active>
<a href=/www.aptly.info/doc/feature/query/>Package Queries</a>
</li><li>
<a href=/www.aptly.info/doc/feature/duplicate/>Duplicate Packages</a>
</li><li>
<a href=/www.aptly.info/doc/feature/s3/>Publishing to S3</a>
</li><li>
<a href=/www.aptly.info/doc/feature/swift/>Publishing to Swift</a>
</li><li>
<a href=/www.aptly.info/doc/feature/filesystem/>Filesystem Publishing</a>
</li><li>
<a href=/www.aptly.info/doc/feature/multi-component/>Multi-Component Publishing</a>
</li><li>
<a href=/www.aptly.info/doc/feature/pgp-providers/>PGP Providers</a>
</li><li>
<a href=/www.aptly.info/doc/feature/package-display/>Package Display Format</a>
</li><li>
<a href=/www.aptly.info/doc/feature/dependencies/>Dependency Resolving</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/configuration/>Configuration</a>
</li><li>
<a href=/www.aptly.info/doc/commands/>Commands</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/aptly/flags/>Global Flags</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/mirror/>aptly mirror</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/aptly/mirror/create/>aptly mirror create</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/mirror/update/>aptly mirror update</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/mirror/list/>aptly mirror list</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/mirror/show/>aptly mirror show</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/mirror/edit/>aptly mirror edit</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/mirror/search/>aptly mirror search</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/mirror/rename/>aptly mirror rename</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/mirror/drop/>aptly mirror drop</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/aptly/repo/>aptly repo</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/aptly/repo/create/>aptly repo create</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/add/>aptly repo add</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/include/>aptly repo include</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/import/>aptly repo import</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/show/>aptly repo show</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/list/>aptly repo list</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/copy/>aptly repo copy</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/move/>aptly repo move</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/remove/>aptly repo remove</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/search/>aptly repo search</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/edit/>aptly repo edit</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/rename/>aptly repo rename</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/repo/drop/>aptly repo drop</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/>aptly snapshot</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/aptly/snapshot/create/>aptly snapshot create</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/list/>aptly snapshot list</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/show/>aptly snapshot show</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/verify/>aptly snapshot verify</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/pull/>aptly snapshot pull</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/filter/>aptly snapshot filter</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/diff/>aptly snapshot diff</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/merge/>aptly snapshot merge</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/search/>aptly snapshot search</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/rename/>aptly snapshot rename</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/snapshot/drop/>aptly snapshot drop</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/aptly/package/>aptly package</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/aptly/package/search/>aptly package search</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/package/show/>aptly package show</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/aptly/publish/>aptly publish</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/aptly/publish/snapshot/>aptly publish snapshot</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/publish/repo/>aptly publish repo</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/publish/update/>aptly publish update</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/publish/switch/>aptly publish switch</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/publish/list/>aptly publish list</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/publish/show/>aptly publish show</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/publish/drop/>aptly publish drop</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/aptly/db/>aptly db</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/aptly/db/cleanup/>aptly db cleanup</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/db/recover/>aptly db recover</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/aptly/task/>aptly task</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/aptly/task/run/>aptly task run</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/aptly/serve/>aptly serve</a>
</li><li>
<a href=/www.aptly.info/doc/aptly/config/>aptly config</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/aptly/config/show/>aptly config show</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/aptly/graph/>aptly graph</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/api/>API</a>
<ul class=nav>
<li>
<a href=/www.aptly.info/doc/api/repos/>Local Repos API</a>
</li><li>
<a href=/www.aptly.info/doc/api/files/>File Upload API</a>
</li><li>
<a href=/www.aptly.info/doc/api/snapshots/>Snapshot API</a>
</li><li>
<a href=/www.aptly.info/doc/api/publish/>Publish API</a>
</li><li>
<a href=/www.aptly.info/doc/api/packages/>Package API</a>
</li><li>
<a href=/www.aptly.info/doc/api/misc/>Misc API</a>
</li></ul></li><li>
<a href=/www.aptly.info/doc/integrations/>Integrations</a>
</li></ul><div class=source-buttons>
<a href=/www.aptly.info/download/ class="btn btn-danger">Download</a>
<a href=https://github.com/aptly-dev/aptly class="btn btn-default">Github</a>
</div></div></div><div class="col-md-9 col-sm-9 col-xs-9">
<h2 id=package-queries>Package Queries</h2><p>Some commands accept package queries to identify list of packages to
process. Package query syntax almost matches <code>reprepro</code> query language.
Query consists of the following simple terms:</p><ul>
<li><strong>direct package reference</strong>: reference to exactly one package.
Format is identical to the way aptly lists packages in show commands
with <code>-with-packages</code> flag: <code>name_version_arch</code>, e.g.:
<code>libmysqlclient18_5.5.35-rel33.0-611.squeeze_amd64</code></li><li><strong>dependency condition</strong>: syntax follows Debian dependency
specification: <code>package_name</code> followed by optional version
specification and architecture limit, e.g: <code>mysql-client (>= 3.6)</code>.</li><li><strong>query against package fields</strong>: syntax is the same as for dependency
conditions, but instead of package name field name is used, e.g:
<code>Priority (optional)</code>.</li></ul><p>Supported fields:</p><ul>
<li>all field names from Debian package control files are supported
except for <code>Filename</code>, <code>MD5sum</code>, <code>SHA1</code>, <code>SHA256</code>, <code>Size</code>, <code>Files</code>,
<code>Checksums-SHA1</code>, <code>Checksums-SHA256</code>.</li><li><code>$Source</code> is a name of source package (for binary packages)</li><li><code>$SourceVersion</code> is a version of source package</li><li><code>$Architecture</code> is <code>Architecture</code> for binary packages and <code>source</code>
for source packages, when matching with equal (<code>=</code>) operator,
package with <code>any</code> architecture matches all architectures but
<code>source</code>.</li><li><code>$Version</code> has the same value as <code>Version</code>, but comparison operators
use Debian version precedence rules</li><li><code>$PackageType</code> is <code>deb</code> for binary packages, <code>udeb</code> for .udeb packages
and <code>source</code> for source packages</li></ul><p>Operators:</p><ul>
<li><code>=</code>: strict match, default operator is no operator is given</li><li><code>>=</code>, <code>&lt;=</code>, <code>=</code>, <code>>></code> (strictly greater), <code>&lt;&lt;</code> (strictly less):
lexicographical comparison for all fields and special rules when
comparing package versions</li><li><code>%</code>: pattern matching, like shell patterns, supported special
symbols are: <code>[^]?*</code>, e.g.: <code>$Version (% 3.5-*)</code></li><li><code>~</code>: regular expression matching, e.g.: <code>Name (~ .*-dev)</code></li></ul><p>Simple terms could be combined into more complex queries using operators
<code>,</code> (and), <code>|</code> (or) and <code>!</code> (not), parentheses <code>()</code> are used to change
operator precedence. Match value could be enclosed in single (<code>'</code>) or
double (<code>"</code>) quotes if required to resolve ambiguity, quotes inside
quoted string should escaped with slash (<code>\</code>).</p><p>Examples:</p><ul>
<li><code>mysql-client</code>: matches package mysql-client of any version and
architecture (including source), also matches packages that
<code>Provide:</code> <code>mysql-client</code>.</li><li><code>mysql-client (>= 3.6)</code>: matches package mysql-client with version
greater or equal to 3.6. Valid operators for version are: <code>>=</code>,
<code>&lt;=</code>, <code>=</code>, <code>>></code> (strictly greater), <code>&lt;&lt;</code> (strictly less).</li><li><code>mysql-client {i386}</code>: matches package <code>mysql-client</code> on
architecture <code>i386</code>, architecture <code>all</code> matches all architectures
but source.</li><li><code>mysql-client (>= 3.6) {i386}</code>: version and architecture conditions
combined.</li><li><code>libmysqlclient18_5.5.35-rel33.0-611.squeeze_amd64</code>: direct package
reference.</li><li><code>$Source (nginx)</code>: all binary packages with <code>nginx</code> as source
package.</li><li><code>!Name (~ .*-dev), mail-transport, $Version (>= 3.5)</code>: matches all
packages that provide <code>mail-transport</code> with name that has no suffix
<code>-dev</code> and with version greater or equal to <code>3.5</code>.</li><li><code>Name</code>: query matches all the packages (as it means &ldquo;package name is not
empty&rdquo;).</li></ul><p>When specified on command line, query may have to be quoted according to
shell rules, so that it stays single argument:</p><pre><code>$ aptly repo import percona stable 'mysql-client (&gt;= 3.6)'
</code></pre><p>You can use package queries filter mirrors to include only packages with limited
priorities:</p><pre><code>$ aptly mirror create -filter=&quot;Priority (required)&quot; wheezy-required http://mirror.yandex.ru/debian/ wheezy main
</code></pre><p>Or download single packages and all its dependencies:</p><pre><code>$ aptly mirror create -filter=&quot;nginx&quot; -filter-with-deps wheezy-required http://mirror.yandex.ru/debian/ wheezy main
</code></pre><p>Pull packages with complex conditions:</p><pre><code>$ aptly snapshot pull snapshot1 source snapshot2 '!Name (% *-dev), $Version (&gt;= 3.5)'
</code></pre><p>Or remove packages based on query:</p><pre><code>$ aptly repo remove local-repo 'Name (% http-*) | $Source (webserver)'
</code></pre><p>Query could be tested by using family of search commands: for <a href=/doc/aptly/mirror/search/>mirrors</a>,
<a href=/doc/aptly/snapshot/search/>snapshots</a> and <a href=/doc/aptly/repo/search/>local repos</a>.</p><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var e=document.createElement("script"),t,n,s;e.type="text/javascript",e.async=!0,t="aptly",n="Package Queries",s="/www.aptly.info/doc/feature/query/".replace(/\/$/,""),e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script>
<noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div></div></section><footer id=page-footer>
<div class=container>
<nav class="navbar navbar-default navbar-static-top" role=navigation>
<ul class="nav navbar-nav nav-justified">
<li><a href=/www.aptly.info/tutorial/>tutorials</a></li><li><a href=/www.aptly.info/download/>download</a></li><li><a href=/www.aptly.info/support/>support</a></li><li class=active><a href=/www.aptly.info/doc/overview/>documentation</a></li><li><a href=/www.aptly.info/about/>about</a></li><li><a href=/www.aptly.info/post/>blog</a></li></ul></nav><div class=copy>
Sponsored by <a href=http://express42.com/>express42</a> &copy;&nbsp;2013-2018 aptly contributors
</div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js></script>
<script src=/www.aptly.info/js/bootstrap.min.js></script>
<script src=/www.aptly.info/js/aptly.js></script>
<script>(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-6065617-2","aptly.info"),ga("send","pageview")</script>
</body></html>